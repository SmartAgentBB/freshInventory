<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fresh Inventory</title>
    <link href="{{ url_for('static', filename='css/output.css') }}" rel="stylesheet">
</head>
<body class="bg-gray-50">
    <!-- 상단 네비게이션 바 -->
    <div class="fixed top-0 left-0 right-0 bg-white shadow-sm border-b z-40">
        <div class="container mx-auto px-4 py-3">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <rect x="1" y="1" width="22" height="22" rx="3" fill="white" stroke="currentColor" stroke-width="2"/>
                        <line x1="5" y1="6" x2="5" y2="9" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M15.5154 10C15.5768 10 15.6485 10.0103 15.7304 10.031C16.3038 10.1135 16.5904 10.4334 16.5904 10.9907C16.5904 11.1765 16.5392 11.4551 16.4369 11.8266C16.0478 13.3127 15.8328 14.2208 15.7918 14.5511C16.1399 14.2828 16.6416 13.7874 17.2969 13.065C17.9932 12.3013 18.5256 11.9195 18.8942 11.9195C19.0785 11.9195 19.2526 11.9711 19.4164 12.0743C19.8055 12.322 20 12.6729 20 13.1269C20 13.4572 19.8259 13.7255 19.4778 13.9319C19.314 14.0351 19.0375 14.1383 18.6485 14.2415C17.2355 14.6336 16.3754 14.8916 16.0683 15.0155C16.4778 15.1806 16.959 15.3354 17.5119 15.4799C18.6792 15.7895 19.3242 15.9752 19.4471 16.0372C19.7747 16.2229 19.9488 16.5119 19.9693 16.904C19.9693 17.0485 19.9386 17.193 19.8771 17.3375C19.6724 17.8328 19.3549 18.0805 18.9249 18.0805C18.5973 18.0805 18.116 17.7606 17.4812 17.1207C16.6212 16.192 16.0478 15.6347 15.7611 15.4489C15.8225 15.903 15.9352 16.4293 16.099 17.0279C16.4266 18.1631 16.5904 18.8132 16.5904 18.9783C16.5904 19.0402 16.5802 19.1022 16.5597 19.1641C16.4778 19.7214 16.1195 20 15.4846 20C15.4232 20 15.3515 19.9897 15.2696 19.969C14.6962 19.8865 14.4096 19.5666 14.4096 19.0093C14.4096 18.8235 14.4608 18.5449 14.5631 18.1734C14.9522 16.6873 15.1672 15.7792 15.2082 15.4489C14.8805 15.6966 14.3993 16.161 13.7645 16.8421C13.0068 17.6677 12.4539 18.0805 12.1058 18.0805C11.9215 18.0805 11.7474 18.0289 11.5836 17.9257C11.1945 17.678 11 17.3271 11 16.8731C11 16.5428 11.1741 16.2745 11.5222 16.0681C11.686 15.9649 11.9625 15.8617 12.3515 15.7585C13.7645 15.3664 14.6246 15.1084 14.9317 14.9845C14.5222 14.8194 14.041 14.6646 13.4881 14.5201C12.3208 14.2105 11.6758 14.0248 11.5529 13.9628C11.2253 13.7771 11.0512 13.4881 11.0307 13.096C11.0307 12.9515 11.0614 12.807 11.1229 12.6625C11.3276 12.1672 11.6451 11.9195 12.0751 11.9195C12.4232 11.9401 12.884 12.2394 13.4573 12.8173C14.3379 13.7255 14.9215 14.2931 15.2082 14.5201C15.1468 14.0867 15.0444 13.581 14.901 13.0031C14.5734 11.8266 14.4096 11.1662 14.4096 11.0217C14.4096 10.9598 14.4198 10.8978 14.4403 10.8359C14.5222 10.2786 14.8805 10 15.5154 10Z" fill="currentColor"/>
                    </svg>
                    <h1 class="text-xl font-bold text-gray-800">Fresh Inventory</h1>
                </div>
                <div class="flex items-center space-x-3">
                    <button id="cooking-btn" class="p-2 text-gray-600 hover:text-gray-800">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 27 23">
                            <path d="M6.73871 11.549V13.8024M21.4532 11.549V20.4071C21.4532 20.4071 19.8362 22 14.2172 22C8.59823 22 6.73871 20.4071 6.73871 20.4071V13.8024M21.4532 13.8024C23.4609 13.3103 27.2374 9.60609 24.5 5.5C22.5 2.5 18.7559 3.54568 18.7559 3.54568M6.73871 13.8024C4.27283 13.4527 0.39795 11.5118 2.50001 6.5C3.96798 3 8.05924 3.05356 9.3663 4.01189C10.0931 2.50793 11.7891 0.0964034 16 1.50001C19 2.5 19.5 5.5 19 7.50002M9 10.2281C9.49857 9.91728 11.533 9.30343 14.2172 9.33452C16.9014 9.3656 18.744 10.2151 19 10.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                    <button id="shoppinglist-btn" class="p-2 text-gray-600 hover:text-gray-800">
                        <svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M15.6476 7C16.8806 7 17.8199 8.1048 17.6216 9.32172L16.4807 16.3217C16.323 17.2893 15.4872 18 14.5068 18H4.72475C3.7625 18 2.93666 17.3148 2.75909 16.3691L1.4448 9.36906C1.21368 8.1381 2.15798 7 3.41046 7H15.6476Z" stroke="currentColor" stroke-width="2"/>
                            <path d="M5.5 12.5L8 15L13 10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            <path d="M6 7C6 7 6 1 9.50001 1C13 1 13 7 13 7" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </button>
                    <button class="p-2 text-gray-600 hover:text-gray-800">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="container mx-auto px-4 py-6 mt-16">

        <!-- 탭 버튼 -->
        <div class="flex items-center mb-6 border-b border-gray-200">
            <button id="tab-current" class="tab-btn px-6 py-3 text-sm font-medium border-b-2 border-cyan-500 text-cyan-600 transition-colors">
                내 재고 목록
            </button>
            <button id="tab-frozen" class="tab-btn px-6 py-3 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 transition-colors">
                냉동
            </button>
            <button id="tab-history" class="tab-btn px-6 py-3 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 transition-colors">
                지난 기록
            </button>
        </div>

        <!-- 현재 재고 탭 -->
        <div id="current-inventory-tab" class="tab-content">
            <div class="mb-6">
                <!-- 검색 입력창 (기본적으로 숨김) -->
                <div id="search-container" class="mb-4 hidden">
                    <div class="relative">
                        <input type="text" id="search-input" placeholder="재료명을 입력하세요..." 
                               class="w-full px-4 py-2 pl-10 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent">
                        <svg class="absolute left-3 top-2.5 w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                        <button id="close-search" class="absolute right-3 top-2.5 text-gray-400 hover:text-gray-600">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                
                <div class="flex items-center justify-between mb-4">
                    <!-- 정렬 버튼 -->
                    <div class="flex items-center space-x-2">
                        <button id="sort-newest" class="sort-btn bg-cyan-500 text-white px-3 py-1 rounded-lg text-xs font-medium hover:bg-cyan-600 transition-colors">
                            최신순
                        </button>
                        <button id="sort-oldest" class="sort-btn bg-gray-200 text-gray-700 px-3 py-1 rounded-lg text-xs font-medium hover:bg-gray-300 transition-colors">
                            오래된순
                        </button>
                        <button id="sort-urgent" class="sort-btn bg-gray-200 text-gray-700 px-3 py-1 rounded-lg text-xs font-medium hover:bg-gray-300 transition-colors">
                            임박순
                        </button>
                    </div>
                    <div class="flex items-center space-x-3">
                        <button id="search-btn" class="p-2 text-gray-600 hover:text-gray-800">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                            </svg>
                        </button>
                        <span class="text-sm text-gray-500" id="item-count">총 0개</span>
                    </div>
                </div>
                <div id="inventory-list" class="space-y-3">
                    <!-- 인벤토리 아이템들이 여기에 로드됩니다 -->
                </div>
            </div>
        </div>

        <!-- 냉동 탭 -->
        <div id="frozen-tab" class="tab-content hidden">
            <div class="mb-6">
                <div class="flex items-center justify-between mb-4">
                    <!-- 정렬 버튼 -->
                    <div class="flex items-center space-x-2">
                        <button id="sort-frozen-newest" class="sort-btn bg-cyan-500 text-white px-3 py-1 rounded-lg text-xs font-medium hover:bg-cyan-600 transition-colors">
                            최신순
                        </button>
                        <button id="sort-frozen-oldest" class="sort-btn bg-gray-200 text-gray-700 px-3 py-1 rounded-lg text-xs font-medium hover:bg-gray-300 transition-colors">
                            오래된순
                        </button>
                    </div>
                    <span class="text-sm text-gray-500" id="frozen-count">총 0개</span>
                </div>
                <div id="frozen-list" class="space-y-3">
                    <!-- 냉동 아이템들이 여기에 로드됩니다 -->
                </div>
            </div>
        </div>

        <!-- 지난 기록 탭 -->
        <div id="history-tab" class="tab-content hidden">
            <div class="mb-6">
                <div class="flex justify-between w-full">
                    <p class="text-sm text-gray-600">최근에 소비한 재료를 확인하세요.</p>
                    <span class="text-sm text-gray-500" id="history-count">총 0개</span>
                </div>
            </div>
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr class="border-b border-gray-200">
                                    <th class="text-left p-2 text-sm font-medium text-gray-700 w-12"></th>
                                    <th class="text-left p-4 text-sm font-medium text-gray-700">이름 (수량)</th>
                                    <th class="text-left p-4 text-sm font-medium text-gray-700">소비기간</th>
                                    <th class="text-left p-4 text-sm font-medium text-gray-700">사용량/폐기량</th>
                                    <th class="text-left p-4 text-sm font-medium text-gray-700"></th>
                                </tr>
                            </thead>
                            <tbody id="history-table">
                                <!-- 지난 기록이 여기에 동적으로 추가됩니다 -->
                            </tbody>
                        </table>
                    </div> 
            </div>
        </div>

        <!-- 플로팅 액션 버튼 -->
        <button id="add-item-btn" class="fixed bottom-6 right-6 bg-cyan-500 hover:bg-cyan-600 text-white rounded-full w-14 h-14 flex items-center justify-center text-2xl shadow-lg transition-all duration-200 hover:scale-110">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
            </svg>
        </button>
    </div>

    <!-- 모달 오버레이 -->
    <div id="add-item-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-6 w-full max-w-md mx-4 max-h-[90vh] overflow-y-auto">
            <!-- 모달 헤더 -->
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold text-gray-800">새 재료 추가</h2>
                <button id="close-modal" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>

            <!-- 이미지 업로드 섹션 -->
            <div id="image-upload-section" class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">이미지 업로드</label>
                <div class="border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:border-cyan-400 transition-colors">
                    <input type="file" id="image-upload" accept="image/*" class="hidden">
                    <div class="cursor-pointer" onclick="document.getElementById('image-upload').click()">
                        <svg class="mx-auto h-12 w-12 text-gray-400 mb-4" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                            <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        <p class="text-sm text-gray-600">클릭하여 이미지 선택</p>
                        <p class="text-xs text-gray-500 mt-1">JPG, PNG 파일 지원</p>
                    </div>
                </div>
            </div>

            <!-- 이미지 프리뷰 -->
            <div id="image-preview" class="mb-6"></div>

            <!-- AI 분석 결과 -->
            <div id="ai-results" class="mb-6"></div>

            <!-- 액션 버튼 -->
            <div class="flex space-x-3">
                <button id="cancel-btn" class="flex-1 bg-gray-100 text-gray-700 px-4 py-3 rounded-xl font-medium hover:bg-gray-200 transition-colors">
                    취소
                </button>
                <button id="save-btn" class="flex-1 bg-cyan-500 text-white px-4 py-3 rounded-xl font-medium hover:bg-cyan-600 transition-colors">
                    저장
                </button>
            </div>
        </div>
    </div>

    <!-- 남은 양 수정 모달 -->
    <div id="edit-remains-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-6 w-full max-w-md mx-4">
            <!-- 모달 헤더 -->
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold text-gray-800">상세</h2>
                <button id="close-edit-modal" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>

            <!-- 아이템 정보 -->
            <div class="mb-6">
                <div class="flex items-center space-x-4 mb-4">
                    <img id="edit-item-image" src="" alt="" class="w-16 h-16 rounded-lg object-cover border border-gray-200">
                    <div class="flex-grow min-w-0">
                        <h3 id="edit-item-name" class="text-lg font-semibold text-gray-800 truncate"></h3>
                        <div class="flex items-center space-x-4 mt-1">
                            <span id="edit-item-quantity" class="text-sm text-gray-600"></span>
                            <span id="edit-item-date" class="text-sm text-gray-500"></span>
                            <span id="edit-item-expiry" class="text-sm text-gray-500"></span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 남은 양 슬라이더 -->
            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">남은 양</label>
                <div class="flex items-center space-x-4">
                    <div class="flex-1 relative">
                        <div class="w-full bg-gray-200 rounded-lg h-2">
                            <div id="slider-progress" class="bg-cyan-500 h-2 rounded-lg" style="width: 0%"></div>
                        </div>
                        <input type="range" id="remains-slider" min="0" max="100" step="5" class="absolute inset-0 w-full h-2 bg-transparent rounded-lg appearance-none cursor-pointer slider">
                    </div>
                    <span id="remains-value" class="text-lg font-semibold text-gray-800 w-16 text-center">0%</span>
                </div>
            </div>

            <!-- 사용 이력 -->
            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">사용 이력</label>
                <div class="bg-gray-50 rounded-lg overflow-hidden border border-gray-200">
                    <!-- 고정 헤더 -->
                    <div class="bg-gray-100 border-b border-gray-200">
                        <div class="p-2">
                            <table class="w-full text-sm table-fixed">
                                <colgroup>
                                    <col style="width: 50%;">
                                    <col style="width: 50%;">
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th class="text-center text-gray-700 font-semibold py-1">날짜</th>
                                        <th class="text-center text-gray-700 font-semibold py-1">사용량</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                    </div>
                    <!-- 스크롤 가능한 데이터 영역 -->
                    <div id="history-table-container" class="overflow-y-auto" style="max-height: 120px;">
                        <div class="p-3 pt-2">
                            <table class="w-full text-sm table-fixed">
                                <colgroup>
                                    <col style="width: 50%;">
                                    <col style="width: 50%;">
                                </colgroup>
                                <tbody id="history-table-body">
                                    <!-- 이력 데이터가 여기에 동적으로 추가됩니다 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 보관 정보 -->
            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">보관 정보</label>
                <div class="bg-blue-50 rounded-lg p-4 border border-blue-200">
                    <div class="mb-3">
                        <div class="flex items-center mb-1">
                            <svg class="w-4 h-4 text-blue-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <span class="text-sm font-medium text-blue-800">권장 소비기간 : </span>
                            <span class="text-sm text-blue-700 ml-2" id="storage-desc">정보 없음</span>
                        </div>
                        <p id="storage-method" class="text-sm text-blue-700 ml-6 mt-2">정보 없음</p>
                    </div>
                </div>
            </div>

            <!-- 액션 버튼 -->
            <div class="flex space-x-3">
                <button id="consume-btn" class="flex-1 bg-green-500 text-white px-4 py-3 rounded-xl font-medium hover:bg-green-600 transition-colors">
                    소비
                </button>
                <button id="freeze-btn" class="flex-1 bg-blue-500 text-white px-4 py-3 rounded-xl font-medium hover:bg-blue-600 transition-colors">
                    냉동
                </button>
                <button id="waste-btn" class="flex-1 text-white px-4 py-3 rounded-xl font-medium transition-colors" style="background-color: #4b5563;">
                    폐기
                </button>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
